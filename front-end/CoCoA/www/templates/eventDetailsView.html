
<ion-view data-ng-init="eventDetailsView()" hide-back-button="isEditMode">
  <ion-nav-buttons id="eventdetail-nav" side="left">
    <h1 class="title">{{eventInfo.title}} - Details</h1>
    <a id="edit-btn" class="button button-clear button-positive" ng-click="toggleEventDetailEditMode()" >Edit</a>
  </ion-nav-buttons>
  <ion-content class="squeezed-content">
  <div class="list" id="eventDetailList">

    <div ng-if="isEditMode">
        <label class="item item-input item-stacked-label">
          <div class="row">
            <div class="col col-33"><p class="info-label">Start Date</p></div>
            <div class="col col-67">
              <input type="date" ng-model="eventInfo.startDate">
            </div>
          </div>
        </label>

        <label class="item item-input item-stacked-label">
          <div class="row">
            <div class="col col-33"><p class="info-label">End Date</p></div>
            <div class="col col-67">
              <input type="date" ng-model="eventInfo.endDate">
            </div>
          </div>
        </label>
    </div>

    <div ng-if="!isEditMode">
      <label class="item item-input item-stacked-label">
        <div class="row">
          <div class="col col-33"><p class="info-label">Date</p></div>
          <div class="col col-67">
            <p ng-if="eventInfo.startDate && eventInfo.endDate && eventInfo.isCurrentYear">{{eventInfo.startDate | date: 'MMM dd'}} - {{eventInfo.endDate | date: 'MMM dd'}}</p>
            <p ng-if="eventInfo.startDate && eventInfo.endDate && !eventInfo.isCurrentYear">{{eventInfo.startDate | date: 'MMM dd, yyyy'}} - {{eventInfo.endDate | date: 'MMM dd, yyyy'}}</p>
            <p ng-if="eventInfo.startDate && !eventInfo.endDate && eventInfo.isCurrentYear">{{eventInfo.startDate | date: 'MMM dd'}} </p>
            <p ng-if="eventInfo.startDate && !eventInfo.endDate && !eventInfo.isCurrentYear">{{eventInfo.startDate | date: 'MMM dd, yyyy'}} </p>
            <p ng-if="!eventInfo.startDate && eventInfo.endDate && eventInfo.isCurrentYear">{{eventInfo.endDate} | date: 'MMM dd'} </p>
            <p ng-if="!eventInfo.startDate && eventInfo.endDate && !eventInfo.isCurrentYear">{{eventInfo.endDate} | date: 'MMM dd, yyyy'} </p>
          </div>
        </div>
      </label>
    </div>
    <label class="item item-input item-stacked-label">
      <div class="row">
        <div class="col col-33">
          <p class="info-label">Time</p>
        </div>
        <div class="col col-67">
          <input type="time" placeholder="Event Time" ng-show="isEditMode" ng-model="eventInfo.time">
          <p ng-show="!isEditMode">{{eventInfo.time | date:'h:mma'}}</p>
        </div>
      </div>
    </label>
    <label class="item item-input item-stacked-label">
      <div class="row">
        <div class="col col-33">
          <p class="info-label">Venue</p>
        </div>
        <div class="col col-67">
          <input type="text" placeholder="Event Venue" ng-show="isEditMode" ng-model="eventInfo.venue">
          <p ng-show="!isEditMode">{{eventInfo.venue}}</p>
        </div>
      </div>
    </label>

    <label class="item item-input item-stacked-label" ng-show="isEditMode || eventInfo.studentsNeeded">
      <div class="row">
        <div class="col col-33">
          <p class="info-label">Students Type</p>
        </div>
        <div class="col col-67">
          <input type="text" placeholder="Number of Students Needed" ng-show="isEditMode" ng-model="eventInfo.studentsNeeded">
          <p ng-show="!isEditMode && eventInfo.studentsNeeded">{{eventInfo.studentsNeeded}}</p>
        </div>
      </div>
    </label>

    <label class="item item-input item-stacked-label" ng-show="isEditMode || eventInfo.reportTime">
      <div class="row">
        <div class="col col-33 item-text-wrap">
          <p class="info-label">Report Time</p>
        </div>
        <div class="col col-67">
          <input type="time" ng-show="isEditMode" placeholder="Reporting time on day of the event" ng-model="eventInfo.reportTime">
          <p ng-show="!isEditMode">{{eventInfo.reportTime}}</p>
        </div>
      </div>
    </label>

    <label class="item item-input item-stacked-label" ng-show="isEditMode || eventInfo.reportVenue">
      <div class="row">
        <div class="col col-33 item-text-wrap">
          <p class="info-label">Report Venue</p>
        </div>
        <div class="col col-67">
          <input type="text" placeholder="Reporting venu on day of the event" ng-show="isEditMode" ng-model="eventInfo.reportVenue">
          <p ng-show="!isEditMode">{{eventInfo.reportVenue}}</p>
        </div>
      </div>
    </label>

    <label class="item item-input item-stacked-label" ng-show="isEditMode || eventInfo.TOIC">
      <div class="row">
        <div class="col col-33 item-text-wrap">
          <p class="info-label">Teacher IC</p>
        </div>
        <div class="col col-67">
          <input type="text" placeholder="TO In Charge" ng-show="isEditMode" ng-model="eventInfo.TOIC">
          <p ng-show="!isEditMode">{{eventInfo.TOIC}}</p>
        </div>
      </div>
    </label>

    <label class="item item-input item-stacked-label" ng-if="isEditMode">
      <div class="row">
        <div class="col col-33">
          <p class="info-label">Notes</p>
        </div>
        <div class="col col-67">
          <textarea ng-model="eventInfo.comments" value="eventInfo.comments" ng-show="isEditMode" placeholder="Extra notes of the event"></textarea>
        </div>
      </div>
    </label>

    <label class="item item-input item-stacked-label" ng-if="!isEditMode && eventInfo.comments">
      <div class="row">
        <div class="col col-33">Notes</div>
        <div class="col col-67"></div>
      </div>
      <div class="row">
        <p class="col">{{eventInfo.comments}}</p>
      </div>
    </label>

        <div class="item item-divider"></div>
            
        <div class="item participants-divider" ng-if="!isEditMode">
          View participants
        </div>
        <div class="item participants-divider" ng-if="isEditMode">
          Choose participants
        </div>
        <form>
          <label class="item item-input search">
            <i class='icon ion-search placeholder-icon'></i>
            <input type="text" ng-model="stdNameFilter" placeholder="Search">     
          </input>
          </label>
        </form>
        <ion-list ng-if="!isEditMode">
          <div class="item item-divider" ng-repeat-start="(initial, participants) in partViewModel">{{initial}}</div>
          <ion-item class="participants-row" ng-repeat="student in participants track by student.id" ng-if="student.selected && (!stdNameFilter || student.name.toLowerCase().indexOf(stdNameFilter.toLowerCase())) > -1"  ng-click="toggleStuInfoDisplay(student.id)" ng-class="{'highlighted' : selectedRow == student.id}">
            <p>{{student.name}}</p>
            <div ng-show="selectedRow == student.id" class="item-animate">
                <br>
                <label>Class</label>
                <p>{{student.data.class}}</p>
                <hr>
                <label>Tel</label>
                <p>{{student.data.contactNumber}}</p>
            </div>
          </ion-item>
          <div ng-repeat-end></div>
        </ion-list>

        <ion-list ng-if="isEditMode">
          <div class="item item-divider" ng-repeat-start="(initial, participants) in participantsEditModel">{{initial}}</div>
          <ion-item class="participants-row" ng-repeat="student in participants" ng-if="!stdNameFilter || student.name.toLowerCase().indexOf(stdNameFilter.toLowerCase()) > -1"  ng-class="{'highlighted' : selectedRow == student.id}">
            <i class="icon ion-checkmark-circled" ng-click="chooseParticipant(student.id)" ng-if="student.selected" stop-event></i>
            <i class="icon ion-ios7-circle-outline" ng-click="chooseParticipant(student.id)" ng-if="!student.selected" stop-event></i>
           <span ng-click="toggleStuInfoDisplay(student.id)">{{student.name}}</span>
            <div ng-show="selectedRow == student.id" class="item-animate">
              <br>
              <label>Class</label>
              <p>{{student.data.class}}</p>
              <hr>
              <label>Tel</label>
              <p>{{student.data.guardian_contact_mobile}}</p>
            </div>
          </ion-item>
          <div ng-repeat-end></div>
        </ion-list>
    </div>
  </ion-content>
        <button menu-toggle="left"  id="menu-toggle" class="button button-icon"><span class="ion-chevron-left"></span></button>

</ion-view>
